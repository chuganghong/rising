{include file="header.html"}
<link href="../css/validationEngine.jquery.css" rel="stylesheet" type="text/css" />
<script src="../js/jquery.validationEngine.js" type="text/javascript"></script>
<script src="../js/jquery.validationEngine-cn.js" type="text/javascript"></script>
<script>
{literal}
function setTab(name,cursel,n){   
	for(i = 1;i<=n;i++){   
		var menu = document.getElementById(name+i);   
		var con  = document.getElementById("con_"+name+"_"+i);   
		menu.className = i == cursel ? "tab-front":"tab-back";   
		con.style.display = i == cursel ? "block":"none";   
	}   
}
{/literal}
</script>
<div class="main-div">
<form action="" method="post" name="theForm" id="theForm">
<div id="tabbar-div">
    <p>
      <span class="tab-front" id="one1" onclick="setTab('one',1,3)">通用信息</span>
      <span class="tab-back" id="one2" onclick="setTab('one',2,3)">邮件服务器设置</span>
      <span class="tab-back" id="one3" onclick="setTab('one',3,3)">其他设置</span>
    </p>
</div>
<div id="con_one_1" style="padding:10px;">
  <table width="100%" border="0" cellspacing="2" cellpadding="2">
    <tr>
      <td class="label">站点描述:</td>
      <td><input type="text" name="value[{$sys_config.12.id}]" value="{$sys_config.12.value}" size="40"></td>
    </tr>
    <tr>
      <td class="label">站点关键字:</td>
      <td><input type="text" name="value[{$sys_config.13.id}]" value="{$sys_config.13.value}" size="40"></td>
    </tr>
    
  	<tr>
      <td class="label">站点访问统计:</td>
      <td><label><input type="radio" name="value[{$sys_config.11.id}]" value="on" {if $sys_config.11.value eq 'on'}checked="true"{/if} />开启</label>
          <label><input type="radio" name="value[{$sys_config.11.id}]" value="off" {if $sys_config.11.value eq 'off'}checked="true"{/if} />关闭</label></td>
    </tr>
    
  	<tr>
      <td class="label">积分兑换比率:</td>
      <td><input type="text" name="value[{$sys_config.9.id}]" value="{$sys_config.9.value}"> 分<br />
      <span class="notice-span">一元人民币兑换多少积分</span></td>
    </tr>
    <tr>
      <td class="label">消耗积分数量:</td>
      <td><input type="text" name="value[{$sys_config.10.id}]" value="{$sys_config.10.value}"> 条<br />
      <span class="notice-span">查看一次联系方式所消耗的积分数量</span></td>
    </tr>
    
  	<tr>
      <td class="label">显示商铺条数:</td>
      <td><input type="text" name="value[{$sys_config.7.id}]" value="{$sys_config.7.value}"> 条<br />
      <span class="notice-span">交易中心顶部显示商铺的条数</span></td>
    </tr>
    <tr>
      <td class="label">刷新频率:</td>
      <td><input type="text" name="value[{$sys_config.8.id}]" value="{$sys_config.8.value}"> 秒<br />
      <span class="notice-span">交易中心商铺的自动刷新频率</span></td>
    </tr>
    <tr>
      <td class="label">允许上传的文件类型:</td>
      <td><input type="text" name="value[{$sys_config.14.id}]" value="{$sys_config.14.value}" size="40"><br />
      <span class="notice-span">格式为 *.zip 不同格式用 | 分隔</span></td>
    </tr>
    <tr>
      <td class="label">敏感信息过滤:</td>
      <td><textarea name="value[{$sys_config.0.id}]" cols="80" rows="10">{$sys_config.0.value}</textarea><br />
      <span class="notice-span">不同词语用 | 分隔</span></td>
    </tr>
  </table>
</div>
<div id="con_one_2" style="display:none; padding:10px;">
<div id="board">
   <span class="text-key"><p>
    如果您的服务器支持 Mail 函数（具体信息请咨询您的空间提供商）。我们建议您使用系统的 Mail 函数。<br />
    当您的服务器不支持 Mail 函数的时候您也可以选用 SMTP 作为邮件服务器。</p>
   </span>
</div>
  <table width="100%" border="0" cellspacing="2" cellpadding="2">
    <tr>
      <td class="label">邮件服务:</td>
      <td>
      <label for="value_{$sys_config.6.id}_0">
      <input type="radio" name="value[{$sys_config.6.id}]" value="0" id="value_{$sys_config.6.id}_0" {if $sys_config.6.value eq 0} checked="true"{/if} />采用服务器内置的 Mail 服务</label>
      <label for="value_{$sys_config.6.id}_1">
      <input type="radio" name="value[{$sys_config.6.id}]" value="1" id="value_{$sys_config.6.id}_1" {if $sys_config.6.value} checked="true"{/if} />采用其他的 SMTP 服务
      </label><br />
      <span class="notice-span">如果您选择了采用服务器内置的 Mail 服务，您不需要填写下面的内容。</span></td>
    </tr>
    <tr>
      <td class="label">发送邮件服务器地址(SMTP):</td>
      <td><input type="text" name="value[{$sys_config.1.id}]" value="{$sys_config.1.value}" size="40"><br />
      <span class="notice-span">邮件服务器主机地址。如果本机可以发送邮件则设置为localhost</span></td>
    </tr>
    <tr>
      <td class="label">服务器端口:</td>
      <td><input type="text" name="value[{$sys_config.2.id}]" value="{$sys_config.2.value}" size="40"></td>
    </tr>
    <tr>
      <td class="label">邮件发送帐号:</td>
      <td><input type="text" name="value[{$sys_config.3.id}]" value="{$sys_config.3.value}" size="40"><br />
      <span class="notice-span">发送邮件所需的帐号</span></td>
    </tr>
    <tr>
      <td class="label">帐号密码:</td>
      <td><input type="password" name="value[{$sys_config.4.id}]" value="{$sys_config.4.value}" size="40"></td>
    </tr>
    <tr>
      <td class="label">邮件回复地址:</td>
      <td><input type="text" name="value[{$sys_config.5.id}]" value="{$sys_config.5.value}" size="40"></td>
    </tr>
    <tr>
      <td class="label">邮件地址:</td>
      <td>
      <input type="text" name="test_mail_address" size="30" />
      <input type="button" value="发送测试邮件" onclick="sendTestEmail();" class="button" />
      </td>
    </tr>
  </table>
</div>
<div id="con_one_3" style="display:none; padding:10px;">
其他设置
</div>
  <div class="button-div" style="clear:both">
    <input type="submit" class="button" value=" 确定 " />
    <input type="reset" class="button" value=" 重置 " />
    <input type="hidden" name="act" value="{$form_act}" />
  </div>
</form>
</div>
{literal}
<script type="text/javascript">
<!--
/**
 * 测试邮件的发送
 */
function sendTestEmail()
{
  var eles              = document.forms['theForm'].elements;
  var smtp_host         = eles['value[2]'].value;
  var smtp_port         = eles['value[3]'].value;
  var smtp_user         = eles['value[4]'].value;
  var smtp_pass         = eles['value[5]'].value;
  var reply_email       = eles['value[6]'].value;
  var test_mail_address = eles['test_mail_address'].value;
 
  var mail_charset = 'utf-8';
  var mail_service = 0;
 
  for (i = 0; i < eles['value[7]'].length; i++)
  {
    if (eles['value[7]'][i].checked)
    {
      mail_service = eles['value[7]'][i].value;
    }
  }
 
  AjaxCall('sys_config.php?is_ajax=1&act=send_test_email',
    'email=' + test_mail_address + '&mail_service=' + mail_service + '&smtp_host=' + smtp_host + '&smtp_port=' + smtp_port +
    '&smtp_user=' + smtp_user + '&smtp_pass=' + encodeURIComponent(smtp_pass) + '&reply_email=' + reply_email + '&mail_charset=' + mail_charset,
    emailResponse, 'POST', 'JSON');
}
 
/**
 * 邮件发送的反馈信息
 */
function emailResponse(result)
{
  alert(result.message);
}
//-->
</script>
{/literal}
{include file="footer.html"}